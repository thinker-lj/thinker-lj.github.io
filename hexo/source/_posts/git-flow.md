---
title: 用更加优雅的方式做事：Git Flow
date: 2016-02-11 15:33:50
tags: [git, 项目管理, 敏捷]
categories: [项目日常]
---

![](/images/gitflow_p0.jpg)

> 软件就像性，免费的比花钱的好得多…
<p align="right">—— 李纳斯·托沃兹</p>

-------

# & 引子
网络时代，随便找个地方，不等Git三个字母敲完，资料就出来了。所以，这篇只聊个人观点，项目实战后的感悟。不喜，随意喷！对朋友，我骂人比谁都脏……

-------

# & 从SVN谈起：

提到版本控制系统，首先要聊两句更纯粹些的SVN，之所以说它纯粹，是因为这种集中式的数据仓库更符合常规思维，它只提供一种途径，这样每个人都使用着相同的方式。
而Git却不仅仅是个版本控制系统，大家更愿意把它理解成一个强大的文件系统；虽然不能完全说Git可以取代SVN（实际上它正在做这件事），因为SVN仍然有它的使用场景（例如项目中存在部分无法公开的内容）。
但Git 的分布式管理方式更加便捷，分支管理更加轻松，内容更具完整性；这也是我们团队最终从SVN 迁移到Git主要原因。

-------

# & Git Flow

> 便利的工具在没有规范约束时，往往会成为双刃剑……

​	在开聊Git Flow前，下面这张图可以看到模型的全貌（引自nvie的[博文](http://nvie.com/posts/a-successful-git-branching-model/))：

![](/images/gitflow_p1.png)

​	图一放，顿时不想聊太多了……

-------

# & 讲故事

​	Git Flow让我想起了当年的铁道游击队骑着自行车追火车的场景，先把正义感抛开，不管目的是军需还是兵力补充，小范围来看火车都是 **master branch** 了。所以在火车跑起来之前，安全策略就要提前规划好。不要让游击队这种小的 **develop branch** 随意的merge！Github Flow的 **Pull request** 也好，Gitlab flow的 **Merge request**也罢，无非就是为了保证上了火车的人都是经过 **code review** 的。
<!-- more -->
​	扯回正常的项目开发流程，每个靠谱的项目都不可能只存在一个 **protect branch** ，至少每个开发周期都会存在类似铁道游击队中的自行车（呃，又扯回去了…）这类起初protect，项目上线后可能去删除掉的分支。请记住 **merge** 的方向，一定是先从主到次，再 **merge** 回主，这样可以规避掉手动 **merge** 产生的冲突对主分支的影响；

​	既然又提到了铁道游击队，就再多聊一些，作为游击队员，无论是否已经登上火车（是否成功merge），遇到巡逻人员（需要切分支处理线上问题等，总之遇到 **commit** 的理由）时，比 **commit** 更明智的决定（前提是此时残缺的功能不适合commit）是 **git stash** 。这种暂存功能太贴心，完全可以等巡逻鬼子走后，一个 **git apply** 继续倒腾没摆放好的炸药！玩high了啊，既然提到炸药，再假想个可怕的情况，游击队员把炸药放错了地方（开发人员这种事常干），这时没必要大动干戈，一个 **git reset** 别让炸弹响就完了，千万不要搞太大又是 **git revert** ， **checkout** 重新搞……

-------

# & 最后

​	项目开发虽然没有上述故事的主题那样牵扯到民族大义、生死存亡，但对于一个有追求的程序员一个专业的团队，任何能够提高开发效率的方法，都值得去尝试！

​	以上是团队将项目从SVN 迁移到Gitlab后，团队试错踩坑后的些许感悟。今天聊到这，大家去实践吧…

